"use strict";var Eden=(()=>{var q=Object.defineProperty;var re=Object.getOwnPropertyDescriptor;var se=Object.getOwnPropertyNames;var ae=Object.prototype.hasOwnProperty;var ie=(e,t)=>{for(var n in t)q(e,n,{get:t[n],enumerable:!0})},oe=(e,t,n,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of se(t))!ae.call(e,s)&&s!==n&&q(e,s,{get:()=>t[s],enumerable:!(r=re(t,s))||r.enumerable});return e};var ce=e=>oe(q({},"__esModule",{value:!0}),e);var ve={};ie(ve,{edenFetch:()=>ne,edenTreaty:()=>te,treaty:()=>Q});var v=class extends Error{constructor(n,r){super(r+"");this.status=n;this.value=r}};var fe=/(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))/,de=/(?:Sun|Mon|Tue|Wed|Thu|Fri|Sat)\s(?:Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s\d{2}\s\d{4}\s\d{2}:\d{2}:\d{2}\sGMT(?:\+|-)\d{4}\s\([^)]+\)/,ye=/^(?:(?:(?:(?:0?[1-9]|[12][0-9]|3[01])[/\s-](?:0?[1-9]|1[0-2])[/\s-](?:19|20)\d{2})|(?:(?:19|20)\d{2}[/\s-](?:0?[1-9]|1[0-2])[/\s-](?:0?[1-9]|[12][0-9]|3[01]))))(?:\s(?:1[012]|0?[1-9]):[0-5][0-9](?::[0-5][0-9])?(?:\s[AP]M)?)?$/,ue=e=>e.trim().length!==0&&!Number.isNaN(Number(e)),_=e=>{if(typeof e!="string")return null;let t=e.replace(/"/g,"");if(fe.test(t)||de.test(t)||ye.test(t)){let n=new Date(t);if(!Number.isNaN(n.getTime()))return n}return null},le=e=>{let t=e.charCodeAt(0),n=e.charCodeAt(e.length-1);return t===123&&n===125||t===91&&n===93},pe=e=>JSON.parse(e,(t,n)=>{let r=_(n);return r||n}),j=e=>{if(!e)return e;if(ue(e))return+e;if(e==="true")return!0;if(e==="false")return!1;let t=_(e);if(t)return t;if(le(e))try{return pe(e)}catch{}return e},D=e=>{let t=e.data.toString();return t==="null"?null:j(t)};var I=class{constructor(t){this.url=t;this.ws=new WebSocket(t)}ws;send(t){return Array.isArray(t)?(t.forEach(n=>this.send(n)),this):(this.ws.send(typeof t=="object"?JSON.stringify(t):t.toString()),this)}on(t,n,r){return this.addEventListener(t,n,r)}off(t,n,r){return this.ws.removeEventListener(t,n,r),this}subscribe(t,n){return this.addEventListener("message",t,n)}addEventListener(t,n,r){return this.ws.addEventListener(t,s=>{if(t==="message"){let a=D(s);n({...s,data:a})}else n(s)},r),this}removeEventListener(t,n,r){return this.off(t,n,r),this}close(){return this.ws.close(),this}};var he=["get","post","put","delete","patch","options","head","connect","subscribe"],z=["localhost","127.0.0.1","0.0.0.0"],U=typeof FileList>"u",G=e=>U?e instanceof Blob:e instanceof FileList||e instanceof File,ge=e=>{if(!e)return!1;for(let t in e)if(G(e[t])||Array.isArray(e[t])&&e[t].find(G))return!0;return!1},J=e=>U?e:new Promise(t=>{let n=new FileReader;n.onload=()=>{let r=new File([n.result],e.name,{lastModified:e.lastModified,type:e.type});t(r)},n.readAsArrayBuffer(e)}),M=(e,t,n={},r={})=>{if(Array.isArray(e)){for(let s of e)if(!Array.isArray(s))r=M(s,t,n,r);else{let a=s[0];if(typeof a=="string")r[a.toLowerCase()]=s[1];else for(let[i,d]of a)r[i.toLowerCase()]=d}return r}if(!e)return r;switch(typeof e){case"function":if(e instanceof Headers)return M(e,t,n,r);let s=e(t,n);return s?M(s,t,n,r):r;case"object":if(e instanceof Headers)return e.forEach((a,i)=>{r[i.toLowerCase()]=a}),r;for(let[a,i]of Object.entries(e))r[a.toLowerCase()]=i;return r;default:return r}};async function*me(e){let t=e.body;if(!t)return;let n=t.getReader(),r=new TextDecoder,s="";try{for(;;){let{done:a,value:i}=await n.read();if(a)break;s+=r.decode(i,{stream:!0});let d;for(;(d=s.indexOf(`

`))>=0;){let F=s.slice(0,d);s=s.slice(d+2);let p=Z(F);if(p?.event==="error")throw new v(500,p.data);p&&(yield p.data)}}if(s.trim()){let a=Z(s);a&&(yield a)}}finally{n.releaseLock()}}function Z(e){let t="message",n="",r,s=e.split(`
`);for(let a of s)a.startsWith("event:")?t=a.slice(6).trim():a.startsWith("data:")?n+=a.slice(5).trim():a.startsWith("id:")&&(r=a.slice(3).trim());return!t||!n?null:{event:t,data:Ee(n),id:r}}function Ee(e){try{return JSON.parse(e)}catch{return e}}var K=(e,t,n=[],r)=>new Proxy(()=>{},{get(s,a){return K(e,t,a==="index"?n:[...n,a],r)},apply(s,a,[i,d]){if(!i||d||typeof i=="object"&&Object.keys(i).length!==1||he.includes(n.at(-1))){let F=[...n],p=F.pop(),w="/"+F.join("/"),{fetcher:R=fetch,headers:O,onRequest:h,onResponse:m,fetch:L}=t,x=p==="get"||p==="head"||p==="subscribe";O=M(O,w,d);let N=x?i?.query:d?.query,S="";if(N){let o=(T,A)=>{S+=(S?"&":"?")+`${encodeURIComponent(T)}=${encodeURIComponent(A)}`};for(let[T,A]of Object.entries(N)){if(Array.isArray(A)){for(let c of A)o(T,c);continue}o(T,`${A}`)}}if(p==="subscribe"){let o=e.replace(/^([^]+):\/\//,e.startsWith("https://")?"wss://":e.startsWith("http://")||z.find(T=>e.includes(T))?"ws://":"wss://")+w+S;return new I(o)}return(async()=>{let o={method:p?.toUpperCase(),body:i,...L,headers:O};o.headers={...O,...M(x?i?.headers:d?.headers,w,o)};let T=x&&typeof i=="object"?i.fetch:d?.fetch;if(o={...o,...T},x&&delete o.body,h){Array.isArray(h)||(h=[h]);for(let y of h){let f=await y(w,o);typeof f=="object"&&(o={...o,...f,headers:{...o.headers,...M(f.headers,w,o)}})}}if(x&&delete o.body,ge(i)){let y=new FormData;for(let[f,l]of Object.entries(o.body)){if(U){y.append(f,l);continue}if(l instanceof File){y.append(f,await J(l));continue}if(l instanceof FileList){for(let E=0;E<l.length;E++)y.append(f,await J(l[E]));continue}if(Array.isArray(l)){for(let E=0;E<l.length;E++){let b=l[E];y.append(f,b instanceof File?await J(b):b)}continue}y.append(f,l)}o.body=y}else typeof i=="object"?(o.headers["content-type"]="application/json",o.body=JSON.stringify(i)):i!=null&&(o.headers["content-type"]="text/plain");if(x&&delete o.body,h){Array.isArray(h)||(h=[h]);for(let y of h){let f=await y(w,o);typeof f=="object"&&(o={...o,...f,headers:{...o.headers,...M(f.headers,w,o)}})}}let A=e+w+S,c=await(r?.handle(new Request(A,o))??R(A,o)),g=null,u=null;if(m){Array.isArray(m)||(m=[m]);for(let y of m)try{let f=await y(c.clone());if(f!=null){g=f;break}}catch(f){f instanceof v?u=f:u=new v(422,f);break}}if(g!==null)return{data:g,error:u,response:c,status:c.status,headers:c.headers};switch(c.headers.get("Content-Type")?.split(";")[0]){case"text/event-stream":g=me(c);break;case"application/json":g=await c.json();break;case"application/octet-stream":g=await c.arrayBuffer();break;case"multipart/form-data":let y=await c.formData();g={},y.forEach((f,l)=>{g[l]=f});break;default:g=await c.text().then(j)}return(c.status>=300||c.status<200)&&(u=new v(c.status,g),g=null),{data:g,error:u,response:c,status:c.status,headers:c.headers}})()}return typeof i=="object"?K(e,t,[...n,Object.values(i)[0]],r):K(e,t,n)}}),Q=(e,t={})=>typeof e=="string"?(t.keepDomain||(e.includes("://")||(e=(z.find(n=>e.includes(n))?"http://":"https://")+e),e.endsWith("/")&&(e=e.slice(0,-1))),K(e,t)):(typeof window<"u"&&console.warn("Elysia instance server found on client side, this is not recommended for security reason. Use generic type instead."),K("http://e.ly",t,[],e));var X=(e,t,n)=>{if(e.endsWith("/")||(e+="/"),t==="index"&&(t=""),!n||!Object.keys(n).length)return`${e}${t}`;let r="";for(let[s,a]of Object.entries(n))r+=`${s}=${a}&`;return`${e}${t}?${r.slice(0,-1)}`};var V=typeof FileList>"u",Y=e=>V?e instanceof Blob:e instanceof FileList||e instanceof File,we=e=>{if(!e)return!1;for(let t in e){if(Y(e[t]))return!0;if(Array.isArray(e[t])&&e[t].find(n=>Y(n)))return!0}return!1},B=e=>V?e:new Promise(t=>{let n=new FileReader;n.onload=()=>{let r=new File([n.result],e.name,{lastModified:e.lastModified,type:e.type});t(r)},n.readAsArrayBuffer(e)}),H=class{ws;url;constructor(t){this.ws=new WebSocket(t),this.url=t}send(t){return Array.isArray(t)?(t.forEach(n=>this.send(n)),this):(this.ws.send(typeof t=="object"?JSON.stringify(t):t.toString()),this)}on(t,n,r){return this.addEventListener(t,n,r)}off(t,n,r){return this.ws.removeEventListener(t,n,r),this}subscribe(t,n){return this.addEventListener("message",t,n)}addEventListener(t,n,r){return this.ws.addEventListener(t,s=>{if(t==="message"){let a=D(s);n({...s,data:a})}else n(s)},r),this}removeEventListener(t,n,r){return this.off(t,n,r),this}close(){return this.ws.close(),this}},ee=(e,t="",n)=>new Proxy(()=>{},{get(r,s,a){return ee(e,`${t}/${s.toString()}`,n)},apply(r,s,[a,i={}]=[{},{}]){let d=a!==void 0&&(typeof a!="object"||Array.isArray(a))?a:void 0,{$query:F,$fetch:p,$headers:w,$transform:R,getRaw:O,...h}=a??{};d??=h;let m=t.lastIndexOf("/"),L=t.slice(m+1).toUpperCase(),x=X(e,m===-1?"/":t.slice(0,m),Object.assign(i.query??{},F)),N=n.fetcher??fetch,S=n.transform?Array.isArray(n.transform)?n.transform:[n.transform]:void 0,o=R?Array.isArray(R)?R:[R]:void 0;return o&&(S?S=o.concat(S):S=o),L==="SUBSCRIBE"?new H(x.replace(/^([^]+):\/\//,x.startsWith("https://")?"wss://":"ws://")):(async A=>{let c,g={...n.$fetch?.headers,...p?.headers,...i.headers,...w};if(L!=="GET"&&L!=="HEAD"){c=Object.keys(d).length||Array.isArray(d)?d:void 0;let E=c&&(typeof c=="object"||Array.isArray(d));if(E&&we(c)){let $=new FormData;for(let[C,k]of Object.entries(c))if(V)$.append(C,k);else if(k instanceof File)$.append(C,await B(k));else if(k instanceof FileList)for(let W=0;W<k.length;W++)$.append(C,await B(k[W]));else if(Array.isArray(k))for(let W=0;W<k.length;W++){let P=k[W];$.append(C,P instanceof File?await B(P):P)}else $.append(C,k);c=$}else c!=null&&(g["content-type"]=E?"application/json":"text/plain",c=E?JSON.stringify(c):d)}let u=await N(x,{method:L,body:c,...n.$fetch,...i.fetch,...p,headers:g}),y;if(A.getRaw)return u;switch(u.headers.get("Content-Type")?.split(";")[0]){case"application/json":y=await u.json();break;default:y=await u.text().then(j)}let f=u.status>=300||u.status<200?new v(u.status,y):null,l={data:y,error:f,response:u,status:u.status,headers:u.headers};if(S)for(let E of S){let b=E(l);b instanceof Promise&&(b=await b),b!=null&&(l=b)}return l})({getRaw:O})}}),te=(e,t={fetcher:fetch})=>new Proxy({},{get(n,r){return ee(e,r,t)}});var Se=async e=>{switch(e.headers.get("Content-Type")?.split(";")[0]){case"application/json":return e.json();case"application/octet-stream":return e.arrayBuffer();case"multipart/form-data":{let n=await e.formData(),r={};return n.forEach((s,a)=>{r[a]=s}),r}}return e.text().then(j)},be=async(e,t)=>{let n=await Se(e);return e.status>300?{data:null,status:e.status,headers:e.headers,retry:t,error:new v(e.status,n)}:{data:n,error:null,status:e.status,headers:e.headers,retry:t}},ne=(e,t)=>(n,{query:r,params:s,body:a,...i}={})=>{s&&Object.entries(s).forEach(([m,L])=>{n=n.replace(`:${m}`,L)});let d=i.headers?.["Content-Type"];if(!d||d==="application/json")try{a=JSON.stringify(a)}catch{}let F=t?.fetcher||globalThis.fetch,p=r?`?${new URLSearchParams(r).toString()}`:"",w=`${e}${n}${p}`,R=a?{"content-type":"application/json",...i.headers}:i.headers,O={...i,method:i.method?.toUpperCase()||"GET",headers:R,body:a},h=()=>F(w,O).then(m=>be(m,h));return h()};return ce(ve);})();
